<div class="app-container">
  <header class="app-header">
    <div class="header-content">
      <div class="logo-container">
        <svg
          class="app-logo"
          viewBox="0 0 64 64"
          xmlns="http://www.w3.org/2000/svg"
        >
          <!-- Medical cross with shield -->
          <defs>
            <linearGradient
              id="logoGradient"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #14b8a6; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #0d9488; stop-opacity: 1"
              />
            </linearGradient>
          </defs>

          <!-- Shield outline -->
          <path
            class="shield-outline"
            d="M32 4 L50 10 L50 26 C50 38 42 50 32 60 C22 50 14 38 14 26 L14 10 Z"
            fill="none"
            stroke="url(#logoGradient)"
            stroke-width="2"
          />

          <!-- Shield fill with opacity -->
          <path
            class="shield-fill"
            d="M32 6 L48 11 L48 26 C48 37 41 48 32 57 C23 48 16 37 16 26 L16 11 Z"
            fill="url(#logoGradient)"
            opacity="0.15"
          />

          <!-- Medical cross -->
          <rect
            class="cross-vertical"
            x="30"
            y="20"
            width="4"
            height="18"
            fill="#14b8a6"
            rx="1"
          />
          <rect
            class="cross-horizontal"
            x="23"
            y="27"
            width="18"
            height="4"
            fill="#14b8a6"
            rx="1"
          />

          <!-- Anomaly detection pulse/wave line -->
          <path
            class="pulse-wave"
            d="M20 44 L24 44 L26 40 L28 48 L30 44 L32 44 L34 40 L36 48 L38 44 L40 44 L44 44"
            fill="none"
            stroke="#5eead4"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </div>
      <div class="header-text">
        <h1>{{ title }}</h1>
        <p class="subtitle">Real-time Healthcare Payment Anomaly Detection</p>
      </div>
    </div>
  </header>

  <main class="app-content">
    <div class="control-panel">
      <mat-card>
        <mat-card-content>
          <div class="button-group">
            <button
              mat-raised-button
              color="primary"
              (click)="detectAnomalies()"
              [disabled]="loading"
            >
              <mat-spinner
                *ngIf="loading"
                diameter="20"
                class="button-spinner"
              ></mat-spinner>
              {{ loading ? "Analyzing..." : "Analyze 10,000 Random Records" }}
            </button>
            <button
              mat-raised-button
              color="accent"
              (click)="scrollToResults()"
              *ngIf="anomalyData"
              class="view-results-btn"
            >
              <mat-icon>visibility</mat-icon>
              View Anomaly Results
            </button>
          </div>
          <p class="info-text" *ngIf="!loading">
            Click to fetch random records from Athena and detect anomalies using
            ML model
          </p>
        </mat-card-content>
      </mat-card>
    </div>

    <div *ngIf="error" class="error-message">
      <mat-card class="error-card">
        <mat-card-content>
          <h3>Error</h3>
          <p>{{ error }}</p>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Always show dashboard for project info, pass data when available -->
    <app-dashboard *ngIf="!loading" [anomalyData]="anomalyData">
    </app-dashboard>

    <div *ngIf="loading" class="loading-container">
      <mat-spinner diameter="60"></mat-spinner>
      <p>Analyzing records and detecting anomalies...</p>

      <div class="query-display" *ngIf="currentQuery">
        <div class="query-header">
          <mat-icon>search</mat-icon>
          <span>Athena Query Executed:</span>
        </div>
        <pre class="query-content">{{ currentQuery }}</pre>
      </div>
    </div>
  </main>
</div>
